
## 珍爱生命，祝福Windows（吐槽篇）

**Adrian小6**：生命宝贵，不可浪费

---

老6职业使用Mac十几年光景，这次也是为了写这个安装程序msi，逆天的用了把windows写码。搞了两天WiX，语言老旧不说，环境问题会把人逼疯，加上其他各种Windows的老问题还在群魔乱舞，于是写了这个随笔。（备注，windows是好公司，曾经为人类生产力提高做出了巨大贡献，但是，它老了）

MacOS上，用launch4j生成exe最后会因为缺少mingw-w64卡住。所以为了在Windows平台制作exe，我打开了2021年的Windows笔记本（还是很好的）。。。没错，很久没打开了，然后不出预料地进入了`一个小时的更新`。

同样的事情`2017年，考试前备考，windows陷入更新`。后来理所当然全面转向苹果，必须感谢MacOS，**还能提供有效生产力工具供用户选择**。Windows的`更新梗`，到了2023年，竟然还在。

WiX相关文件都是将近十年前的，老旧不说，很不智能。

想智能也行，可以用Advanced Installer，但是可惜，用exe制作MSI，需要付费。用不了两次，但是付费方式是`订阅`，此处一句呵呵。

随后是漫长的环境问题。下载好WiX v4 又需要更新 .NET SDK。结果又是`一个小时的更新，重启，再重启`。

好了，终于可以干活了，然后Jpackage要有Java17，没问题修改Java_Home，然后尝试，结果漫长的`报错`，最后发现大概WiX v4和Java17还`不适配`。

没办法，老老实实变回2019年的 WiX v3。官网写的跟💩一样，下载了v311的exe, 报错，研究结果是需要windows的功能 .NET Framework 3.5（包括.NET 2.0和3.0）要选中打开。没办法，再等待安装，`用了将近两个小时完成更新，重启，再重启`。

老样子，终于更新好了，然后又是`漫长的设置path`。得亏Mac上有点经验，设置好后，终于可以尝试WiX。结果，呵呵。写.wxs文件卡住一天。 各种light installer.wixobj -ext WixUIExtension 就不能一下让你用齐。语言环境也要自己去搜索，或调试。此外同一个软件，提供5种UI样式，结果这几种样式竟然`不兼容`，需要调试。要不然呢，就去交钱。 

此外还有`各种无法删除文件`，显示在使用，但是明明停止了，被啥使用，不知道，解决办法搜不到，`还得重启`，然后打开的各种软件窗口全无。

用Windows写10个小时代码的话，基本4个电脑小时`更新`，3个小时解决`环境`问题，3个小时各种调试`报错`，5个小时研究`旧文档`，5分钟在写代码。

仁者见仁，智者见智。也可能是不熟，但是呢，其实Mac上5分钟dmg就已经导出成功了，并且可以用了，dmg的安装也不用开发者去操心。一样的东西，结果Windows硬是卡住了我两天。我实在是太难过这两天时间的耗费了，因为想自定义，结果还是搞出了个普通版。再画时间肯定能搞出来，但是觉得`耽误事`。

公元2023年了，AI进步很大了，这种设计还在持续，虽有管中窥豹之嫌，但是，那就提对手苹果MacOS吧。想起来用的时候，打开电脑，不用漫长的更新。MacOS的终端也是显示灵活，速度快。对应文件夹下就可响应新文件，也不至于Windows那种调试一般都去各种命名奇怪的temp里。Mac环境变量就一个zsh大文件，直接拷贝，直接编辑。也不需要手动一个一个AddNew。

俗话说，瘦死的骆驼比马大，那大的确还是大的。但是软件是用来跑的，不是用来比大小的。

有个马车，你有需求在上面运一袋粮食，一次就好，但是不好意思需要付钱订这辆车一个月。然后旁边一辆卡车呼啸而过。马车夫一气之下花钱把卡车`收购`了。但是，已经听见旁边一辆火车又呼啸而来。马车夫一气之下花钱把火车也`收购`了。然后，又听见了飞机的轰轰声。

结语，珍爱生命，一起祝福Windows吧。

2023年9月 AY老6 


---

